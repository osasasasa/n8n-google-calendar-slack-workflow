{
  "name": "Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ æœŸé–“æŒ‡å®š â†’ Slacké€šçŸ¥",
  "nodes": [
    {
      "parameters": {
        "path": "calendar-period",
        "formTitle": "Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼äºˆå®šå–å¾—",
        "formDescription": "å–å¾—ã—ãŸã„æœŸé–“ã‚’æŒ‡å®šã—ã¦ãã ã•ã„",
        "formFields": {
          "values": [
            {
              "fieldLabel": "é–‹å§‹æ—¥",
              "fieldType": "date",
              "requiredField": true,
              "name": "é–‹å§‹æ—¥"
            },
            {
              "fieldLabel": "çµ‚äº†æ—¥",
              "fieldType": "date",
              "requiredField": true,
              "name": "çµ‚äº†æ—¥"
            },
            {
              "fieldLabel": "é€šçŸ¥ã™ã‚‹Slackãƒãƒ£ãƒ³ãƒãƒ«",
              "fieldType": "text",
              "requiredField": true,
              "name": "é€šçŸ¥ã™ã‚‹Slackãƒãƒ£ãƒ³ãƒãƒ«",
              "fieldDefaultValue": "#general"
            }
          ]
        },
        "options": {
          "respondWhen": "formSubmitted"
        }
      },
      "id": "form-trigger",
      "name": "æœŸé–“æŒ‡å®šãƒ•ã‚©ãƒ¼ãƒ ",
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.2,
      "position": [240, 300],
      "webhookId": "calendar-period"
    },
    {
      "parameters": {
        "resource": "event",
        "operation": "getAll",
        "calendar": {
          "__rl": true,
          "value": "primary",
          "mode": "list"
        },
        "returnAll": false,
        "limit": 100,
        "timeMin": "={{ $json['é–‹å§‹æ—¥'] + 'T00:00:00+09:00' }}",
        "timeMax": "={{ $json['çµ‚äº†æ—¥'] + 'T23:59:59+09:00' }}",
        "options": {
          "singleEvents": true,
          "orderBy": "startTime"
        }
      },
      "id": "google-calendar-1",
      "name": "Google Calendar",
      "type": "n8n-nodes-base.googleCalendar",
      "typeVersion": 1.3,
      "position": [460, 300],
      "credentials": {
        "googleCalendarOAuth2Api": {
          "id": "YOUR_GOOGLE_CALENDAR_CREDENTIAL_ID",
          "name": "Google Calendar account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// ãƒ•ã‚©ãƒ¼ãƒ ã‹ã‚‰å—ã‘å–ã£ãŸæœŸé–“æƒ…å ±ï¼ˆæ—¥æœ¬èªã®ã‚­ãƒ¼ï¼‰\nconst startDateStr = $json['é–‹å§‹æ—¥'];\nconst endDateStr = $json['çµ‚äº†æ—¥'];\nconst slackChannel = $json['é€šçŸ¥ã™ã‚‹Slackãƒãƒ£ãƒ³ãƒãƒ«'] || '#general';\n\n// æ—¥ä»˜ã‚’DateTimeã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›\nconst startDate = DateTime.fromISO(startDateStr);\nconst endDate = DateTime.fromISO(endDateStr);\n\n// æœŸé–“ã®è¡¨ç¤ºå½¢å¼ã‚’ä½œæˆ\nlet periodDisplay;\nif (startDate.hasSame(endDate, 'day')) {\n  periodDisplay = startDate.toFormat('yyyyå¹´MMæœˆddæ—¥');\n} else if (startDate.hasSame(endDate, 'month')) {\n  periodDisplay = `${startDate.toFormat('yyyyå¹´MMæœˆddæ—¥')}ã€œ${endDate.toFormat('ddæ—¥')}`;\n} else if (startDate.hasSame(endDate, 'year')) {\n  periodDisplay = `${startDate.toFormat('yyyyå¹´MMæœˆddæ—¥')}ã€œ${endDate.toFormat('MMæœˆddæ—¥')}`;\n} else {\n  periodDisplay = `${startDate.toFormat('yyyyå¹´MMæœˆddæ—¥')}ã€œ${endDate.toFormat('yyyyå¹´MMæœˆddæ—¥')}`;\n}\n\n// ã‚¤ãƒ™ãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—\nconst events = $input.all();\n\n// ã‚¤ãƒ™ãƒ³ãƒˆãŒå­˜åœ¨ã—ãªã„å ´åˆã®å‡¦ç†\nif (!events || events.length === 0) {\n  return [{\n    json: {\n      message: `ğŸ“… ${periodDisplay}ã®äºˆå®š\\n\\näºˆå®šãŒã‚ã‚Šã¾ã›ã‚“ ğŸ‰`,\n      eventCount: 0,\n      period: periodDisplay,\n      slackChannel: slackChannel\n    }\n  }];\n}\n\n// æ—¥ä»˜åˆ¥ã«ã‚¤ãƒ™ãƒ³ãƒˆã‚’ã‚°ãƒ«ãƒ¼ãƒ—åŒ–\nconst eventsByDate = {};\n\nevents.forEach(item => {\n  const event = item.json;\n  const startTime = event.start?.dateTime || event.start?.date;\n  \n  if (!startTime) return;\n  \n  try {\n    const eventDate = DateTime.fromISO(startTime).setZone('Asia/Tokyo');\n    const dateKey = eventDate.toFormat('yyyy-MM-dd');\n    const dateDisplay = eventDate.toFormat('MMæœˆddæ—¥ï¼ˆcccï¼‰', {locale: 'ja'});\n    \n    if (!eventsByDate[dateKey]) {\n      eventsByDate[dateKey] = {\n        display: dateDisplay,\n        events: []\n      };\n    }\n    \n    // æ™‚é–“è¡¨ç¤ºã®æ±ºå®š\n    let timeDisplay;\n    if (event.start?.dateTime) {\n      const start = eventDate;\n      const end = event.end?.dateTime ? DateTime.fromISO(event.end.dateTime).setZone('Asia/Tokyo') : null;\n      \n      timeDisplay = end ? \n        `${start.toFormat('HH:mm')}-${end.toFormat('HH:mm')}` : \n        start.toFormat('HH:mm');\n    } else {\n      timeDisplay = 'çµ‚æ—¥';\n    }\n    \n    const title = event.summary || '(ã‚¿ã‚¤ãƒˆãƒ«ãªã—)';\n    const location = event.location ? ` ğŸ“${event.location}` : '';\n    \n    eventsByDate[dateKey].events.push(`  â° ${timeDisplay} ${title}${location}`);\n  } catch (error) {\n    console.error('Error processing event:', error);\n  }\n});\n\n// ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä½œæˆ\nconst dateKeys = Object.keys(eventsByDate).sort();\nlet message = `ğŸ“… ${periodDisplay}ã®äºˆå®š\\n\\nç·äºˆå®šæ•°: ${events.length}ä»¶\\n`;\n\ndateKeys.forEach(dateKey => {\n  const dateData = eventsByDate[dateKey];\n  message += `\\nâ–¶ï¸ ${dateData.display} (${dateData.events.length}ä»¶)\\n`;\n  message += dateData.events.join('\\n') + '\\n';\n});\n\nreturn [{\n  json: {\n    message: message,\n    eventCount: events.length,\n    period: periodDisplay,\n    slackChannel: slackChannel\n  }\n}];"
      },
      "id": "code-1",
      "name": "äºˆå®šæ•´å½¢",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [680, 300]
    },
    {
      "parameters": {
        "resource": "message",
        "operation": "post",
        "select": "channel",
        "channelId": {
          "__rl": true,
          "value": "={{ $json.slackChannel }}",
          "mode": "name"
        },
        "messageType": "text",
        "text": "={{ $json.message }}",
        "otherOptions": {}
      },
      "id": "slack-1",
      "name": "Slacké€šçŸ¥",
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.3,
      "position": [900, 300],
      "credentials": {
        "slackOAuth2Api": {
          "id": "YOUR_SLACK_CREDENTIAL_ID",
          "name": "Slack account"
        }
      }
    }
  ],
  "connections": {
    "æœŸé–“æŒ‡å®šãƒ•ã‚©ãƒ¼ãƒ ": {
      "main": [
        [
          {
            "node": "Google Calendar",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Calendar": {
      "main": [
        [
          {
            "node": "äºˆå®šæ•´å½¢",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "äºˆå®šæ•´å½¢": {
      "main": [
        [
          {
            "node": "Slacké€šçŸ¥",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": {},
  "tags": [],
  "triggerCount": 0,
  "updatedAt": "2025-07-19T10:00:00.000Z",
  "versionId": "1"
}